<!DOCTYPE html>

<html>
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta content="width=device-width, initial-scale=1" name="viewport">
<meta content="#375EAB" name="theme-color">
<title>nego - The PriFi Project</title>
<link href="../../../../.goduckstyle/style.css" rel="stylesheet" type="text/css">
<link href="../../../../.goduckstyle/jquery.treeview.css" rel="stylesheet">
<script type="text/javascript">window.initFuncs = [];</script>
</link></link></meta></meta></meta></head>
<body>
<div id="lowframe" style="position: fixed; bottom: 0; left: 0; height: 0; width: 100%; border-top: thin solid grey; background-color: white; overflow: auto;">
...
</div><!-- #lowframe -->
<div class="wide" id="topbar"><div class="container">
<div class="top-heading" id="heading-wide">The PriFi Project</div>
<div class="top-heading" id="heading-narrow"><a href="/">Go</a></div>
<a href="#" id="menu-button"><span id="menu-button-arrow">▽</span></a>
<form action="/search" method="GET">
<div id="menu">





</div>
</form>
</div></div>
<div class="wide" id="page">
<div class="container">
<h1>Package nego</h1>
<div id="nav"></div>
<!--
	Copyright 2009 The Go Authors. All rights reserved.
	Use of this source code is governed by a BSD-style
	license that can be found in the LICENSE file.
-->
<!--
	Note: Static (i.e., not template-generated) href and id
	attributes start with "pkg-" to make it impossible for
	them to conflict with generated attributes (some of which
	correspond to Go identifiers).
-->
<script type="text/javascript">
	document.ANALYSIS_DATA = null;
	document.CALLGRAPH = null;
	</script>
<div id="short-nav">
<dl>
<dd><code>import "github.com/dedis/crypto/nego"</code></dd>
</dl>
<dl>
<dd><a class="overviewLink" href="#pkg-overview">Overview</a></dd>
<dd><a class="indexLink" href="#pkg-index">Index</a></dd>
</dl>
</div>
<!-- The package's Name is printed as title by the top-level template -->
<div class="toggleVisible" id="pkg-overview">
<div class="collapsed">
<h2 class="toggleButton" title="Click to show Overview section">Overview ▹</h2>
</div>
<div class="expanded">
<h2 class="toggleButton" title="Click to hide Overview section">Overview ▾</h2>
<p>
Package nego implements cryptographic negotiation
and secret entrypoint finding.
</p>
</div>
</div>
<div class="toggleVisible" id="pkg-index">
<div class="collapsed">
<h2 class="toggleButton" title="Click to show Index section">Index ▹</h2>
</div>
<div class="expanded">
<h2 class="toggleButton" title="Click to hide Index section">Index ▾</h2>
<!-- Table of contents for API; must be named manual-nav to turn off auto nav. -->
<div id="manual-nav">
<dl>
<dd><a href="#BitFill">func BitFill(z, x *big.Int, i, j int, b uint)</a></dd>
<dd><a href="#BitScan">func BitScan(x *big.Int, i, j int, b uint) int</a></dd>
<dd><a href="#Entry">type Entry</a></dd>
<dd>    <a href="#Entry.String">func (e *Entry) String() string</a></dd>
<dd><a href="#Writer">type Writer</a></dd>
<dd>    <a href="#Writer.Layout">func (w *Writer) Layout(suiteLevel map[abstract.Suite]int, entrypoints []Entry, rand cipher.Stream) (int, error)</a></dd>
<dd>    <a href="#Writer.Payload">func (w *Writer) Payload(data []byte, encrypt cipher.Stream) int</a></dd>
<dd>    <a href="#Writer.SetMaxLen">func (w *Writer) SetMaxLen(max int)</a></dd>
<dd>    <a href="#Writer.Write">func (w *Writer) Write(rand cipher.Stream) []byte</a></dd>
</dl>
</div><!-- #manual-nav -->
<h4>Package files</h4>
<p>
<span style="font-size:90%">
<a href="/src/github.com/dedis/crypto/nego/bits.go">bits.go</a>
<a href="/src/github.com/dedis/crypto/nego/byte.go">byte.go</a>
<a href="/src/github.com/dedis/crypto/nego/nego.go">nego.go</a>
<a href="/src/github.com/dedis/crypto/nego/skip.go">skip.go</a>
<a href="/src/github.com/dedis/crypto/nego/tree.go">tree.go</a>
</span>
</p>
</div><!-- .expanded -->
</div><!-- #pkg-index -->
<div class="toggle" id="pkg-callgraph" style="display: none">
<div class="collapsed">
<h2 class="toggleButton" title="Click to show Internal Call Graph section">Internal call graph ▹</h2>
</div> <!-- .expanded -->
<div class="expanded">
<h2 class="toggleButton" title="Click to hide Internal Call Graph section">Internal call graph ▾</h2>
<p>
			  In the call graph viewer below, each node
			  is a function belonging to this package
			  and its children are the functions it
			  calls—perhaps dynamically.
			</p>
<p>
			  The root nodes are the entry points of the
			  package: functions that may be called from
			  outside the package.
			  There may be non-exported or anonymous
			  functions among them if they are called
			  dynamically from another package.
			</p>
<p>
			  Click a node to visit that function's source code.
			  From there you can visit its callers by
			  clicking its declaring <code>func</code>
			  token.
			</p>
<p>
			  Functions may be omitted if they were
			  determined to be unreachable in the
			  particular programs or tests that were
			  analyzed.
			</p>
<!-- Zero means show all package entry points. -->
<ul class="treeview" id="callgraph-0" style="margin-left: 0.5in"></ul>
</div>
</div> <!-- #pkg-callgraph -->
<h2 id="BitFill">func <a href="/src/github.com/dedis/crypto/nego/bits.go?s=606:651#L19">BitFill</a>
<a class="permalink" href="#BitFill">¶</a>
</h2>
<pre>func BitFill(z, x *<a href="../../../../math/big/index.html">big</a>.<a href="../../../../math/big/index.html#Int">Int</a>, i, j <a href="https://golang.org/pkg/builtin/#int">int</a>, b <a href="https://golang.org/pkg/builtin/#uint">uint</a>)</pre>
<p>
Set z to x, but with the bit-field from bit i
up or down to bit j filled with bit value b.
</p>
<h2 id="BitScan">func <a href="/src/github.com/dedis/crypto/nego/bits.go?s=284:330#L2">BitScan</a>
<a class="permalink" href="#BitScan">¶</a>
</h2>
<pre>func BitScan(x *<a href="../../../../math/big/index.html">big</a>.<a href="../../../../math/big/index.html#Int">Int</a>, i, j <a href="https://golang.org/pkg/builtin/#int">int</a>, b <a href="https://golang.org/pkg/builtin/#uint">uint</a>) <a href="https://golang.org/pkg/builtin/#int">int</a></pre>
<p>
Scan a bit-field within x starting from bit i,
either upward or downward to but not including bit j,
for the first bit with value b.
Returns the position of the first b-bit found,
or -1 if every bit in the bit-field is set to 1-b.
</p>
<h2 id="Entry">type <a href="/src/github.com/dedis/crypto/nego/nego.go?s=423:639#L11">Entry</a>
<a class="permalink" href="#Entry">¶</a>
</h2>
<pre>type Entry struct {
    Suite  <a href="../../../../github.com/dedis/crypto/abstract/index.html">abstract</a>.<a href="../../../../github.com/dedis/crypto/abstract/index.html#Suite">Suite</a> <span class="comment">// Ciphersuite this public key is drawn from</span>
    PubKey <a href="../../../../github.com/dedis/crypto/abstract/index.html">abstract</a>.<a href="../../../../github.com/dedis/crypto/abstract/index.html#Point">Point</a> <span class="comment">// Public key of this entrypoint's owner</span>
    Data   []<a href="https://golang.org/pkg/builtin/#byte">byte</a>         <span class="comment">// Entrypoint data decryptable by owner</span>
}</pre>
<h3 id="Entry.String">func (*Entry) <a href="/src/github.com/dedis/crypto/nego/nego.go?s=641:672#L17">String</a>
<a class="permalink" href="#Entry.String">¶</a>
</h3>
<pre>func (e *<a href="#Entry">Entry</a>) String() <a href="https://golang.org/pkg/builtin/#string">string</a></pre>
<h2 id="Writer">type <a href="/src/github.com/dedis/crypto/nego/nego.go?s=4791:5340#L144">Writer</a>
<a class="permalink" href="#Writer">¶</a>
</h2>
<pre>type Writer struct {
    <span class="comment">// contains filtered or unexported fields</span>
}</pre>
<p>
Writer produces a cryptographic negotiation header,
which conceals a variable number of "entrypoints"
within a variable-length binary blob of random-looking bits.
Each entrypoint hidden in the blob is discoverable and usable only
by the owner of a particular public key.
Different public keys may be drawn from different ciphersuites,
in any combination, without coordination between the ciphersuites.
</p>
<p>
Each entrypoint contains a short fixed-length blob of encrypted data,
which the owner of the entrypoint can decrypt and use
to obtain keys and pointers to the "real" content.
This "real" content is typically located after the negotiation header
and encrypted with a symmetric key included in the entrypoint data,
which can be (but doesn't have to be) shared by many or all entrypoints.
</p>
<h3 id="Writer.Layout">func (*Writer) <a href="/src/github.com/dedis/crypto/nego/nego.go?s=6830:6944#L186">Layout</a>
<a class="permalink" href="#Writer.Layout">¶</a>
</h3>
<pre>func (w *<a href="#Writer">Writer</a>) Layout(suiteLevel map[<a href="../../../../github.com/dedis/crypto/abstract/index.html">abstract</a>.<a href="../../../../github.com/dedis/crypto/abstract/index.html#Suite">Suite</a>]<a href="https://golang.org/pkg/builtin/#int">int</a>,
    entrypoints []<a href="#Entry">Entry</a>,
    rand <a href="../../../../crypto/cipher/index.html">cipher</a>.<a href="../../../../crypto/cipher/index.html#Stream">Stream</a>) (<a href="https://golang.org/pkg/builtin/#int">int</a>, <a href="https://golang.org/pkg/builtin/#error">error</a>)</pre>
<p>
Initialize a Writer to produce one or more negotiation header
containing a specified set of entrypoints,
whose owners' public keys are drawn from a given set of ciphersuites.
</p>
<p>
The caller must provide a map 'suiteLevel' with one key per ciphersuite,
whose value is the maximum "level" in the header
at which the ciphersuite's ephemeral Diffie-Hellman Point may be encoded.
This maximum level must be standardized for each ciphersuite,
and should be log2(maxsuites), where maxsuites is the maximum number
of unique ciphersuites that are likely to exist when this suite is defined.
</p>
<p>
The Data slices in all entrypoints must have been allocated
and sized according to the data the caller wants to suppy each entrypoint,
but the content of these Data slices need not be filled in yet.
</p>
<p>
This function lays out the entrypoints in the negotiation header,
and returns the total size of the negotiation headers
that will be produced from this layout.
</p>
<p>
After this initialization and layout computation,
multiple independent negotiation headers with varying entrypoint data
may be produced more efficiently via Write().
</p>
<p>
XXX if multiple entrypoints are improperly passed for the same keyholder,
bad things happen to security - we should harden the API against that.
</p>
<h3 id="Writer.Payload">func (*Writer) <a href="/src/github.com/dedis/crypto/nego/nego.go?s=11034:11098#L328">Payload</a>
<a class="permalink" href="#Writer.Payload">¶</a>
</h3>
<pre>func (w *<a href="#Writer">Writer</a>) Payload(data []<a href="https://golang.org/pkg/builtin/#byte">byte</a>, encrypt <a href="../../../../crypto/cipher/index.html">cipher</a>.<a href="../../../../crypto/cipher/index.html#Stream">Stream</a>) <a href="https://golang.org/pkg/builtin/#int">int</a></pre>
<p>
After Layout() has been called to layout the header,
the client may call Payload() any number of times
to reserve regions for encrypted payloads in the message.
Returns the byte offset in the message where the payload was placed.
</p>
<p>
Although the client could as well encrypt the data before calling Payload(),
we take a cleartext and a cipher.Stream to "make sure" it gets encrypted.
(Callers who really want to do their own encryption can pass in
a no-op cipher.Stream, but this isn't recommended.)
</p>
<h3 id="Writer.SetMaxLen">func (*Writer) <a href="/src/github.com/dedis/crypto/nego/nego.go?s=5447:5482#L156">SetMaxLen</a>
<a class="permalink" href="#Writer.SetMaxLen">¶</a>
</h3>
<pre>func (w *<a href="#Writer">Writer</a>) SetMaxLen(max <a href="https://golang.org/pkg/builtin/#int">int</a>)</pre>
<p>
Set the optional maximum length for the negotiation header,
affecting subsequent calls to Layout()
</p>
<h3 id="Writer.Write">func (*Writer) <a href="/src/github.com/dedis/crypto/nego/nego.go?s=11566:11615#L350">Write</a>
<a class="permalink" href="#Writer.Write">¶</a>
</h3>
<pre>func (w *<a href="#Writer">Writer</a>) Write(rand <a href="../../../../crypto/cipher/index.html">cipher</a>.<a href="../../../../crypto/cipher/index.html#Stream">Stream</a>) []<a href="https://golang.org/pkg/builtin/#byte">byte</a></pre>
<p>
Finalize and encrypt the negotiation message.
The data slices in all the entrypoints must be filled in
before calling this function.
</p>

</div><!-- .container -->
</div><!-- #page -->
<!-- TODO(adonovan): load these from <head> using "defer" attribute? -->
<script src="../../../../.goduckstyle/jquery.js" type="text/javascript"></script>
<script src="../../../../.goduckstyle/jquery.treeview.js" type="text/javascript"></script>
<script src="../../../../.goduckstyle/jquery.treeview.edit.js" type="text/javascript"></script>
<script>var goVersion = "go1.7.1";</script>
<script src="../../../../.goduckstyle/godocs.js" type="text/javascript"></script>
</body>
</html>
